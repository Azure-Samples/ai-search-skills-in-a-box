# yaml-language-server: $schema=https://raw.githubusercontent.com/Azure/azure-dev/main/schemas/v1.0/azure.yaml.json

name: aisearch_skills
hooks:
  postprovision:
    windows:
      shell: pwsh
      run: az storage blob upload-batch -d (azd env get-value SEARCH_DATA_SOURCE_CONTAINER) -s ./assets/index_files --account-name (azd env get-value STORAGE_NAME) --auth-mode login 
    posix:
      shell: sh
      run: az storage blob upload-batch -d (azd env get-value SEARCH_DATA_SOURCE_CONTAINER) -s ./assets/index_files --account-name (azd env get-value STORAGE_NAME) --auth-mode login 
  predeploy:
    # updates the .env file with the values from the azd environment
    windows:
      shell: pwsh
      run: azd env get-values > .env && azd env get-values > ./web_api/.env
    posix:
      shell: sh
      run: azd env get-values > .env && azd env get-values > ./web_api/.env
services:
  web_api:
    host: function
    language: python
    project: ./web_api
